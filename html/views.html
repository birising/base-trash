<div class="notice-banner" role="status" aria-label="Upozornění: neoficiální aplikace, testovací provoz, data testovací">
  <span class="notice-label">⚠️ NEOFICIÁLNÍ APLIKACE - TESTOVACÍ PROVOZ - DATA JSOU TESTOVACÍ ⚠️</span>
</div>

<section class="dashboard-strip" aria-label="Rychlé přehledy">
  <div class="strip-header">
    <div>
      <div class="eyebrow">Dashboard</div>
      <div class="headline small">Rychlé přehledy</div>
      <p class="subtitle">Aktuální data z odvozu, hladiny a hlášených závad na jednom místě.</p>
    </div>
  </div>
  <div class="summary-grid dashboard-grid">
    <button class="stat-card" data-category="odpad">
      <div class="stat-top">
        <span class="stat-label">Odpad &amp; sběrný dvůr</span>
        <span class="stat-chip">Plán</span>
      </div>
      <div class="stat-value" id="countOdpad">–</div>
      <div class="stat-sub" id="nextPickupSummary">Každých 14 dní · otevřený dvůr</div>
    </button>
    <button class="stat-card" data-category="hladina">
      <div class="stat-top">
        <span class="stat-label">Hladina potoka</span>
        <span class="stat-chip">Live</span>
      </div>
      <div class="stat-value" id="countHladina">–</div>
      <div class="stat-sub" id="levelReading">Načítám…</div>
    </button>
    <button class="stat-card" data-category="zavady">
      <div class="stat-top">
        <span class="stat-label">Hlášené závady</span>
        <span class="stat-chip">Aktivní</span>
      </div>
      <div class="stat-value" id="countZavady">0</div>
      <div class="stat-sub" id="zavadySummary">Nevyřešené problémy</div>
    </button>
  </div>
</section>

<div class="view-container">
  <div class="map-overlay" id="mapOverlay">
    <div class="layer-switcher hidden" id="greenspaceLayers" aria-label="Vrstevník údržby zeleně">
      <div class="layer-switcher-title">Údržba zeleně</div>
      <label class="layer-switcher-row">
        <input type="checkbox" data-greenspace-layer="trava" checked />
        <span>Tráva</span>
      </label>
      <label class="layer-switcher-row">
        <input type="checkbox" data-greenspace-layer="zahony" checked />
        <span>Záhony</span>
      </label>
    </div>
  </div>
  <div id="mapView" class="view map-view hidden">
    <div id="map" aria-label="Mapa údržby obce Běloky"></div>
  </div>
  <section id="streamView" class="view stream-view hidden" aria-label="Hladina potoka a počasí">
    <div class="stream-grid">
      <div class="stream-card chart-card">
        <div class="chart-header">
          <div>
            <div class="eyebrow">Trend</div>
            <div class="headline small">Posledních 24 hodin</div>
            <div class="chart-sub">CSV + live hodnoty, včetně povodňových stupňů</div>
          </div>
          <div class="chart-actions">
            <button class="chart-refresh" id="refreshStreamBtn" type="button" aria-label="Obnovit data hladiny">
              ↻ Obnovit
            </button>
            <span class="stat-chip subtle">Live</span>
          </div>
        </div>
        <div class="legend" aria-hidden="true">
          <div class="legend-item"><span class="legend-swatch level"></span>Hladina (cm)</div>
          <div class="legend-item"><span class="legend-swatch spa1"></span>SPA 1 · 90 cm</div>
          <div class="legend-item"><span class="legend-swatch spa2"></span>SPA 2 · 100 cm</div>
          <div class="legend-item"><span class="legend-swatch spa3"></span>SPA 3 · 120 cm</div>
        </div>
        <svg id="levelChart" viewBox="0 0 720 320" role="img" aria-label="Graf hladiny potoka"></svg>
      </div>
        <div class="stream-card hero">
          <div class="eyebrow">Hladina potoka</div>
          <div class="stream-headline">Live přehled</div>
          <p class="stream-sub">Aktuální úroveň vody a meteo kontext v jednom panelu.</p>
          <p class="stream-sub">
          Data přejímáme z
          <a
            href="http://hladiny-vox.pwsplus.eu/Senzors/Details/24470"
            target="_blank"
            rel="noopener noreferrer"
          >
            hladiny-vox.pwsplus.eu (#24470)
          </a>
          . Pro nejčerstvější informace přejděte přímo na tuto adresu.
        </p>
        <div class="stream-stats">
          <div class="stat">
            <div class="stat-label">Úroveň</div>
            <div class="stat-value" id="streamLevel">–</div>
            <div class="stat-sub" id="streamUpdated">Načítám…</div>
          </div>
          <div class="stat compact">
            <div class="stat-label">Senzor</div>
            <div class="stat-value">#24470</div>
            <div class="stat-sub">Běloky</div>
          </div>
          <div class="stat compact">
            <div class="stat-label">Zdroj</div>
            <div class="stat-value live" id="streamStatus">Načítám…</div>
            <div class="stat-sub">Online zdroj · hladiny-vox.pwsplus.eu</div>
          </div>
        </div>
        <a
          class="source-link"
          href="http://hladiny-vox.pwsplus.eu/Senzors/Details/24470"
          target="_blank"
          rel="noopener noreferrer"
        >
          Zdroj dat · hladiny-vox.pwsplus.eu (#24470)
        </a>
      </div>
      <div class="stream-card wide">
        <div class="chart-header">
          <div>
            <div class="eyebrow">ČR · počasí</div>
            <div class="headline small">Windy &amp; radar</div>
          </div>
          <span class="stat-chip subtle">Náhled</span>
        </div>
        <div class="weather-embeds inline">
          <div class="embed">
            <iframe
              title="Windy předpověď"
              class="locked-embed"
              src="https://embed.windy.com/embed2.html?lat=49.8175&lon=15.5&detailLat=50.1322&detailLon=14.222&width=100%&height=100%&zoom=7&level=surface&overlay=rain&product=ecmwf&menu=&message=true&type=map&location=coordinates&detail=true&metricWind=ms&metricTemp=%C2%B0C"
              frameborder="0"
              allow="geolocation"
              allowfullscreen
              loading="lazy"
              aria-label="Windy předpověď pro obec Běloky"
              onerror="console.warn('Windy iframe failed to load')"
            ></iframe>
          </div>
          <div class="embed">
            <iframe
              title="Radar srážek"
              class="locked-embed"
              src="https://embed.windy.com/embed2.html?lat=49.8175&lon=15.5&detailLat=50.1322&detailLon=14.222&width=100%&height=100%&zoom=7&level=surface&overlay=radar&product=ecmwf&menu=&message=true&type=map&location=coordinates&detail=true&metricWind=ms&metricTemp=%C2%B0C"
              frameborder="0"
              allow="geolocation"
              allowfullscreen
              loading="lazy"
              aria-label="Radar srážek pro obec Běloky"
              onerror="console.warn('Windy radar iframe failed to load')"
            ></iframe>
          </div>
        </div>
      </div>
    </div>
  </section>
  <section id="hasiciView" class="view hasici-view hidden" aria-label="Zásahy hasičů">
    <div class="view-header">
      <div>
        <div class="eyebrow">Zásahy JPO</div>
        <div class="headline">Poslední zásahy hasičů</div>
        <p class="subtitle">Aktuální zásahy Jednotek požární ochrany Středočeského kraje</p>
      </div>
    </div>
    <div id="hasiciList" class="hasici-list">
      <div class="loading-state">Načítám zásahy…</div>
    </div>
  </section>
  <section id="kriminalitaView" class="view kriminalita-view hidden" aria-label="Kriminalita">
    <div class="view-header">
      <div>
        <div class="eyebrow">Kriminalita</div>
        <div class="headline">Trestná činnost v obci</div>
        <p class="subtitle">Data z <a href="https://kriminalita.policie.gov.cz" target="_blank" rel="noopener">kriminalita.policie.gov.cz</a></p>
      </div>
    </div>
    <div id="kriminalitaList" class="kriminalita-list">
      <div class="loading-state">Načítám data…</div>
    </div>
  </section>
  <section id="zavadyView" class="view zavady-view hidden" aria-label="Hlášené závady">
    <div class="view-header">
      <div>
        <div class="eyebrow">Hlášené závady</div>
        <div class="headline">Přehled nahlášených problémů</div>
        <p class="subtitle">Data z AWS S3</p>
      </div>
      <button id="reportZavadaBtn" class="report-zavada-btn" aria-label="Nahlásit závadu">
        <span class="report-zavada-icon">+</span>
        <span class="report-zavada-label">Nahlásit závadu</span>
      </button>
    </div>
    <div id="zavadyList" class="zavady-list">
      <div class="loading-state">Načítám data…</div>
    </div>
  </section>
  
  <!-- Modal for reporting zavada -->
  <div id="reportZavadaModal" class="report-zavada-modal hidden">
    <div class="report-zavada-modal-backdrop"></div>
    <div class="report-zavada-modal-content">
      <div class="report-zavada-modal-header">
        <h2>Nahlásit závadu</h2>
        <button class="report-zavada-modal-close" aria-label="Zavřít">&times;</button>
      </div>
      <form id="reportZavadaForm" class="report-zavada-form" action="https://formspree.io/f/xkgdbplk" method="POST" enctype="multipart/form-data">
        <input type="hidden" name="form_type" value="zavada_report">
        <label class="report-zavada-form-label">
          Kategorie:
          <select name="category" required class="report-zavada-form-select">
            <option value="">Vyberte kategorii</option>
            <option value="kose">Koš</option>
            <option value="lampy">Lampa</option>
            <option value="zelen">Údržba zeleně</option>
            <option value="ostatni">Ostatní</option>
          </select>
        </label>
        <label class="report-zavada-form-label">
          Váš email:
          <input type="email" name="email" required class="report-zavada-form-input" placeholder="vas@email.cz">
        </label>
        <label class="report-zavada-form-label">
          Popis závady:
          <textarea name="message" rows="4" required class="report-zavada-form-textarea" placeholder="Popište prosím závadu..."></textarea>
        </label>
        <label class="report-zavada-form-label">
          Fotografie (volitelné):
          <input type="file" name="upload" accept="image/*" class="report-zavada-form-input">
        </label>
        <div class="report-zavada-form-actions">
          <button type="button" class="report-zavada-form-cancel">Zrušit</button>
          <button type="submit" class="report-zavada-form-submit">Odeslat</button>
        </div>
      </form>
    </div>
  </div>
  <section id="wasteView" class="view waste-view hidden" aria-label="Odpad a sběrný dvůr">
    <div class="waste-grid">
      <div class="waste-card hero">
        <div class="eyebrow">Odpad &amp; sběrný dvůr</div>
        <div class="headline small">Každých 14 dní</div>
        <div class="mega-date" id="nextPickupDate">–</div>
        <div class="pill primary" id="nextPickupCountdown">Načítám…</div>
        <div class="waste-meta">
          <div>
            <div class="stat-label">Další svoz</div>
            <div class="stat-value" id="nextPickupLabel">–</div>
          </div>
          <div>
            <div class="stat-label">Poslední svoz</div>
            <div class="stat-value" id="lastPickupLabel">17.11.2025</div>
          </div>
          <div>
            <div class="stat-label">Cyklus</div>
            <div class="stat-value">Každých 14 dní</div>
          </div>
        </div>
      </div>
      <div class="waste-card overview">
        <div class="chart-header">
          <div>
            <div class="eyebrow">Harmonogram</div>
            <div class="headline small">Přehled svozu</div>
          </div>
          <span class="stat-chip subtle">Auto</span>
        </div>
        <div class="waste-list" id="upcomingPickups"></div>
      </div>
      <div class="waste-card info">
        <div class="eyebrow">Sběrný dvůr</div>
        <div class="headline small">Běloky</div>
        <ul class="info-list">
          <li><strong>Otevřeno:</strong> denně 8:00–20:00</li>
          <li><strong>Sobota 8:00–16:00:</strong> bioodpad (listí, tráva, větve)</li>
          <li><strong>Další odpad:</strong> přijímáme vše kromě nebezpečného odpadu a pneumatik</li>
          <li><a href="https://mapy.com/cs/zakladni?q=beloky&source=firm&id=13705403&ds=2&x=14.2214283&y=50.1310702&z=18" target="_blank" rel="noopener noreferrer">Zobrazit na mapě</a></li>
        </ul>
        <a class="button ghost" href="mailto:info@beloky.cz?subject=Odpad%20Běloky%20%7C%20Svoz%20nebo%20dv%C5%AFr" aria-label="Nahlásit problém se svozem nebo dvorem">
          Nahlásit problém
        </a>
      </div>
    </div>
  </section>
</div>
