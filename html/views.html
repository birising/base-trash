<section class="dashboard-strip" aria-label="Rychl√© p≈ôehledy">
  <div class="strip-header">
    <div>
      <div class="eyebrow">Dashboard</div>
      <div class="headline small">Rychl√© p≈ôehledy</div>
    </div>
  </div>
  <div class="summary-grid dashboard-grid">
    <button class="stat-card" data-category="odpad">
      <div class="stat-top">
        <span class="stat-label">Komun√°ln√≠ odpad</span>
        <span class="stat-chip">Pl√°n</span>
      </div>
      <div class="stat-value" id="countOdpad">‚Äì</div>
      <div class="stat-sub" id="wasteSbernyDvur">‚Äì</div>
    </button>
    <button class="stat-card" data-category="hladina">
      <div class="stat-top">
        <span class="stat-label">Hladina potoka</span>
        <span class="stat-chip">Live</span>
      </div>
      <div class="stat-value" id="countHladina">‚Äì</div>
      <div class="stat-sub" id="levelReading">Naƒç√≠t√°m‚Ä¶</div>
    </button>
    <button class="stat-card" data-category="zavady">
      <div class="stat-top">
        <span class="stat-label">Hl√°≈°en√© z√°vady</span>
        <span class="stat-chip">Aktivn√≠</span>
      </div>
      <div class="stat-value" id="countZavady">0</div>
      <div class="stat-sub" id="zavadySummary">Nevy≈ôe≈°en√© probl√©my</div>
    </button>
  </div>
</section>

<div class="view-container">
  <div class="map-overlay" id="mapOverlay">
    <div class="greenspace-banner hidden" id="greenspaceBanner">
      <div class="greenspace-banner-content">
        <span class="greenspace-banner-icon">‚ö†Ô∏è</span>
        <div class="greenspace-banner-text-wrapper">
          <span class="greenspace-banner-text">‚ö†Ô∏è NEOFICI√ÅLN√ç/NEZ√ÅVISL√Å APLIKACE ‚ö†Ô∏è</span>
          <span class="greenspace-banner-subtext">Data mohou b√Ωt neaktu√°ln√≠</span>
        </div>
      </div>
    </div>
    <div class="layer-switcher hidden" id="greenspaceLayers" aria-label="Vrstevn√≠k √∫dr≈æby zelenƒõ">
      <div class="layer-switcher-title">√ödr≈æba zelenƒõ</div>
      <label class="layer-switcher-row">
        <input type="checkbox" data-greenspace-layer="trava" checked />
        <span>Tr√°va</span>
      </label>
      <label class="layer-switcher-row">
        <input type="checkbox" data-greenspace-layer="zahony" checked />
        <span>Z√°hony</span>
      </label>
    </div>
    <div class="layer-switcher hidden" id="mapaLayers" aria-label="Vrstevn√≠k mapy">
      <div class="layer-switcher-title">Vrstvy mapy</div>
      <label class="layer-switcher-row">
        <input type="checkbox" data-map-layer="lampy" checked />
        <span>üí° Lampy</span>
      </label>
      <label class="layer-switcher-row">
        <input type="checkbox" data-map-layer="kose" checked />
        <span>üóëÔ∏è Ko≈°e</span>
      </label>
      <label class="layer-switcher-row">
        <input type="checkbox" data-map-layer="zavady" checked />
        <span>üìç Z√°vady</span>
      </label>
      <label class="layer-switcher-row">
        <input type="checkbox" data-map-layer="zelen" checked />
        <span>üåø Zele≈à</span>
      </label>
    </div>
  </div>
  <div id="mapView" class="view map-view hidden">
    <div id="map" aria-label="Mapa √∫dr≈æby obce Bƒõloky"></div>
  </div>
  <section id="streamView" class="view stream-view hidden" aria-label="Hladina potoka a poƒças√≠">
    <div class="stream-grid">
      <div class="stream-card chart-card">
        <div class="chart-header">
          <div>
            <div class="eyebrow">Trend</div>
            <div class="headline small">Posledn√≠ch 12 hodin</div>
            <div class="chart-sub">CSV + live hodnoty, vƒçetnƒõ povod≈àov√Ωch stup≈à≈Ø</div>
          </div>
          <div class="chart-actions">
            <button class="chart-refresh" id="refreshStreamBtn" type="button" aria-label="Obnovit data hladiny">
              ‚Üª Obnovit
            </button>
            <span class="stat-chip subtle">Live</span>
          </div>
        </div>
        <div class="legend" aria-hidden="true">
          <div class="legend-item"><span class="legend-swatch level"></span>Hladina (cm)</div>
          <div class="legend-item"><span class="legend-swatch spa1"></span>SPA 1 ¬∑ 90 cm</div>
          <div class="legend-item"><span class="legend-swatch spa2"></span>SPA 2 ¬∑ 100 cm</div>
          <div class="legend-item"><span class="legend-swatch spa3"></span>SPA 3 ¬∑ 120 cm</div>
        </div>
        <svg id="levelChart" viewBox="0 0 720 320" role="img" aria-label="Graf hladiny potoka"></svg>
      </div>
        <div class="stream-card hero">
          <div class="eyebrow">Hladina potoka</div>
          <div class="stream-headline">Live p≈ôehled</div>
          <p class="stream-sub">Aktu√°ln√≠ √∫rove≈à vody a meteo kontext v jednom panelu.</p>
          <p class="stream-sub">
          Data p≈ôej√≠m√°me z
          <a
            href="http://hladiny-vox.pwsplus.eu/Senzors/Details/24470"
            target="_blank"
            rel="noopener noreferrer"
          >
            hladiny-vox.pwsplus.eu (#24470)
          </a>
          . Pro nejƒçerstvƒõj≈°√≠ informace p≈ôejdƒõte p≈ô√≠mo na tuto adresu.
        </p>
        <div class="stream-stats">
          <div class="stat">
            <div class="stat-label">√örove≈à</div>
            <div class="stat-value" id="streamLevel">‚Äì</div>
            <div class="stat-sub" id="streamUpdated">Naƒç√≠t√°m‚Ä¶</div>
          </div>
          <div class="stat compact">
            <div class="stat-label">Senzor</div>
            <div class="stat-value">#24470</div>
            <div class="stat-sub">Bƒõloky</div>
          </div>
          <div class="stat compact">
            <div class="stat-label">Zdroj</div>
            <div class="stat-value live" id="streamStatus">Naƒç√≠t√°m‚Ä¶</div>
            <div class="stat-sub">Online zdroj ¬∑ hladiny-vox.pwsplus.eu</div>
          </div>
        </div>
        <a
          class="source-link"
          href="http://hladiny-vox.pwsplus.eu/Senzors/Details/24470"
          target="_blank"
          rel="noopener noreferrer"
        >
          Zdroj dat ¬∑ hladiny-vox.pwsplus.eu (#24470)
        </a>
      </div>
      <div class="stream-card wide">
        <div class="chart-header">
          <div>
            <div class="eyebrow">ƒåR ¬∑ poƒças√≠</div>
            <div class="headline small">Windy &amp; radar</div>
          </div>
          <span class="stat-chip subtle">N√°hled</span>
        </div>
        <div class="weather-embeds inline">
          <div class="embed">
            <iframe
              title="Windy p≈ôedpovƒõƒè"
              class="locked-embed"
              src="https://embed.windy.com/embed2.html?lat=49.8175&lon=15.5&detailLat=50.1322&detailLon=14.222&width=100%&height=100%&zoom=7&level=surface&overlay=rain&product=ecmwf&menu=&message=true&type=map&location=coordinates&detail=true&metricWind=ms&metricTemp=%C2%B0C"
              frameborder="0"
              allow="geolocation"
              allowfullscreen
              loading="lazy"
              aria-label="Windy p≈ôedpovƒõƒè pro obec Bƒõloky"
              onerror="console.warn('Windy iframe failed to load')"
            ></iframe>
          </div>
          <div class="embed">
            <iframe
              title="Radar sr√°≈æek"
              class="locked-embed"
              src="https://embed.windy.com/embed2.html?lat=49.8175&lon=15.5&detailLat=50.1322&detailLon=14.222&width=100%&height=100%&zoom=7&level=surface&overlay=radar&product=ecmwf&menu=&message=true&type=map&location=coordinates&detail=true&metricWind=ms&metricTemp=%C2%B0C"
              frameborder="0"
              allow="geolocation"
              allowfullscreen
              loading="lazy"
              aria-label="Radar sr√°≈æek pro obec Bƒõloky"
              onerror="console.warn('Windy radar iframe failed to load')"
            ></iframe>
          </div>
        </div>
      </div>
    </div>
  </section>
  <section id="hasiciView" class="view hasici-view hidden" aria-label="Z√°sahy hasiƒç≈Ø">
    <div class="view-header">
      <div>
        <div class="eyebrow">Z√°sahy JPO</div>
        <div class="headline">Posledn√≠ z√°sahy hasiƒç≈Ø</div>
        <p class="subtitle">Aktu√°ln√≠ z√°sahy Jednotek po≈æ√°rn√≠ ochrany St≈ôedoƒçesk√©ho kraje</p>
      </div>
    </div>
    <div id="hasiciList" class="hasici-list">
      <div class="loading-state"><div class="loading-spinner"></div><span>Naƒç√≠t√°m z√°sahy‚Ä¶</span></div>
    </div>
  </section>
  <section id="kriminalitaView" class="view kriminalita-view hidden" aria-label="Kriminalita">
    <div class="view-header">
      <div>
        <div class="eyebrow">Kriminalita</div>
        <div class="headline">Trestn√° ƒçinnost v obci</div>
        <p class="subtitle">Data z <a href="https://kriminalita.policie.gov.cz" target="_blank" rel="noopener">kriminalita.policie.gov.cz</a></p>
      </div>
    </div>
    <div id="kriminalitaList" class="kriminalita-list">
      <div class="loading-state"><div class="loading-spinner"></div><span>Naƒç√≠t√°m data‚Ä¶</span></div>
    </div>
  </section>
  <section id="zavadyView" class="view zavady-view hidden" aria-label="Hl√°≈°en√© z√°vady">
    <div class="view-header">
      <div>
        <div class="eyebrow">Hl√°≈°en√© z√°vady</div>
        <div class="headline">P≈ôehled nahl√°≈°en√Ωch probl√©m≈Ø</div>
        <p class="subtitle">Data z AWS S3</p>
      </div>
      <div style="display: flex; gap: 12px; align-items: center;">
        <button id="printZavadyBtn" class="report-zavada-btn" aria-label="Tisknout mapu z√°vad" style="background: rgba(34, 197, 94, 0.9); border-color: rgba(34, 197, 94, 1);">
          <span class="report-zavada-icon">üñ®Ô∏è</span>
          <span class="report-zavada-label">Tisk</span>
        </button>
        <button id="reportZavadaBtn" class="report-zavada-btn" aria-label="Nahl√°sit z√°vadu">
          <span class="report-zavada-icon">+</span>
          <span class="report-zavada-label">Nahl√°sit z√°vadu</span>
        </button>
      </div>
    </div>
    <div id="zavadyList" class="zavady-list">
      <div class="loading-state"><div class="loading-spinner"></div><span>Naƒç√≠t√°m data‚Ä¶</span></div>
    </div>
  </section>
  
  <!-- Modal for reporting zavada -->
  <div id="reportZavadaModal" class="report-zavada-modal hidden">
    <div class="report-zavada-modal-backdrop"></div>
    <div class="report-zavada-modal-content">
      <div class="report-zavada-modal-header">
        <h2>Nahl√°sit z√°vadu</h2>
        <button class="report-zavada-modal-close" aria-label="Zav≈ô√≠t">&times;</button>
      </div>
      <form id="reportZavadaForm" class="report-zavada-form" action="https://formspree.io/f/xkgdbplk" method="POST" enctype="multipart/form-data">
        <input type="hidden" name="form_type" value="zavada_report">
        <label class="report-zavada-form-label">
          Kategorie:
          <select name="category" id="reportZavadaCategory" required class="report-zavada-form-select">
            <option value="">Vyberte kategorii</option>
            <option value="kose">Ko≈°</option>
            <option value="lampy">Lampa</option>
            <option value="zelen">√ödr≈æba zelenƒõ</option>
            <option value="ostatni">Ostatn√≠</option>
          </select>
        </label>
        <div id="reportZavadaMapContainer" class="report-zavada-map-container hidden">
          <div class="report-zavada-map-label">Vyberte objekt na mapƒõ:</div>
          <div id="reportZavadaMap" class="report-zavada-map"></div>
          <div id="reportZavadaSelected" class="report-zavada-selected hidden">
            <span class="report-zavada-selected-icon">‚úì</span>
            <span class="report-zavada-selected-text"></span>
          </div>
          <input type="hidden" name="selected_id" id="reportZavadaSelectedId">
          <input type="hidden" name="selected_lat" id="reportZavadaSelectedLat">
          <input type="hidden" name="selected_lng" id="reportZavadaSelectedLng">
          <input type="hidden" name="selected_name" id="reportZavadaSelectedName">
        </div>
        <label class="report-zavada-form-label">
          V√°≈° email:
          <input type="email" name="email" required class="report-zavada-form-input" placeholder="vas@email.cz">
        </label>
        <label class="report-zavada-form-label">
          Popis z√°vady:
          <textarea name="message" rows="4" required class="report-zavada-form-textarea" placeholder="Popi≈°te pros√≠m z√°vadu..."></textarea>
        </label>
        <label class="report-zavada-form-label">
          Fotografie (voliteln√©):
          <input type="file" name="upload" accept="image/*" class="report-zavada-form-input">
        </label>
        <div class="report-zavada-form-actions">
          <button type="button" class="report-zavada-form-cancel">Zru≈°it</button>
          <button type="submit" class="report-zavada-form-submit">Odeslat</button>
        </div>
      </form>
    </div>
  </div>
  
  <!-- Modal for marking zavada as resolved -->
  <div id="resolveZavadaModal" class="report-zavada-modal hidden">
    <div class="report-zavada-modal-backdrop"></div>
    <div class="report-zavada-modal-content">
      <div class="report-zavada-modal-header">
        <h2>Nahl√°≈°en√≠ odstranƒõn√≠ z√°vady</h2>
        <button class="report-zavada-modal-close" aria-label="Zav≈ô√≠t">&times;</button>
      </div>
      <form id="resolveZavadaForm" class="report-zavada-form" action="https://formspree.io/f/xkgdbplk" method="POST">
        <input type="hidden" name="form_type" value="zavada_resolved">
        <input type="hidden" name="zavada_id" id="resolveZavadaId">
        <input type="hidden" name="zavada_category" id="resolveZavadaCategory">
        <input type="hidden" name="zavada_lat" id="resolveZavadaLat">
        <input type="hidden" name="zavada_lng" id="resolveZavadaLng">
        <input type="hidden" name="zavada_reported_date" id="resolveZavadaReportedDate">
        
        <div class="resolve-zavada-details">
          <h3>Detaily z√°vady:</h3>
          <div class="resolve-zavada-detail-item">
            <strong>Popis:</strong>
            <span id="resolveZavadaDescription"></span>
          </div>
          <div class="resolve-zavada-detail-item">
            <strong>Kategorie:</strong>
            <span id="resolveZavadaCategoryLabel"></span>
          </div>
          <div class="resolve-zavada-detail-item">
            <strong>GPS sou≈ôadnice:</strong>
            <span id="resolveZavadaGPS"></span>
          </div>
          <div class="resolve-zavada-detail-item">
            <strong>Datum nahl√°≈°en√≠:</strong>
            <span id="resolveZavadaReportedDateLabel"></span>
          </div>
        </div>
        
        <label class="report-zavada-form-label">
          V√°≈° email (voliteln√©):
          <input type="email" name="email" class="report-zavada-form-input" placeholder="vas@email.cz">
        </label>
        <label class="report-zavada-form-label">
          Pozn√°mka (voliteln√©):
          <textarea name="note" rows="3" class="report-zavada-form-textarea" placeholder="Dopl≈àuj√≠c√≠ informace o odstranƒõn√≠ z√°vady..."></textarea>
        </label>
        <div class="report-zavada-form-actions">
          <button type="button" class="report-zavada-form-cancel">Zru≈°it</button>
          <button type="submit" class="report-zavada-form-submit">Odeslat</button>
        </div>
      </form>
    </div>
  </div>
  
  <section id="wasteView" class="view waste-view hidden" aria-label="Odpad a sbƒõrn√Ω dv≈Ør">
    <div class="waste-grid">
        <div class="waste-card hero">
        <div class="eyebrow">Komun√°ln√≠ odpad</div>
        <div class="headline small" id="nextPickupDateLabel">‚Äì</div>
        <div class="mega-date" id="nextPickupDate">‚Äì</div>
        <div class="pill primary" id="nextPickupCountdown">Naƒç√≠t√°m‚Ä¶</div>
        <div class="waste-meta">
          <div>
            <div class="stat-label">Posledn√≠ svoz</div>
            <div class="stat-value" id="lastPickupLabel">01.12.2025</div>
          </div>
          <div>
            <div class="stat-label">Cyklus</div>
            <div class="stat-value">Ka≈æd√Ωch 14 dn√≠</div>
          </div>
        </div>
      </div>
      <div class="waste-card info">
        <div class="eyebrow">Sbƒõrn√Ω dv≈Ør</div>
        <div class="headline small">Bƒõloky</div>
        <ul class="info-list">
          <li><strong>Otev≈ôeno:</strong> dennƒõ 8:00‚Äì20:00</li>
          <li><strong>Sobota 8:00‚Äì16:00:</strong> bioodpad (list√≠, tr√°va, vƒõtve)</li>
          <li><strong>Dal≈°√≠ odpad:</strong> p≈ôij√≠m√°me v≈°e kromƒõ nebezpeƒçn√©ho odpadu a pneumatik</li>
          <li><a href="https://mapy.com/cs/zakladni?q=beloky&source=firm&id=13705403&ds=2&x=14.2214283&y=50.1310702&z=18" target="_blank" rel="noopener noreferrer">Zobrazit na mapƒõ</a></li>
        </ul>
        <a class="button ghost" href="mailto:info@beloky.cz?subject=Odpad%20Bƒõloky%20%7C%20Svoz%20nebo%20dv%C5%AFr" aria-label="Nahl√°sit probl√©m se svozem nebo dvorem">
          Nahl√°sit probl√©m
        </a>
      </div>
    </div>
  </section>
</div>
